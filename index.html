<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexusXOS 13 RC</title>
    <link id="favicon" rel="icon" href="https://www.google.com/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap" rel="stylesheet">
    <!-- MARKED.JS FOR MARKDOWN PARSING -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            /* --- THEME VARIABLES --- */
            --bg-base: #050505;
            --bg-gradient: radial-gradient(circle at center, #1e293b 0%, #000000 70%);
            --glass-bg: rgba(18, 18, 18, 0.65);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-blur: blur(16px);
            --text-main: #ffffff;
            --text-dim: #94a3b8;
            --accent: #3b82f6;
            --accent-glow: rgba(59, 130, 246, 0.5);
            --card-bg: #111;
            
            /* --- ENHANCED PHYSICS (Springy) --- */
            --fluid: cubic-bezier(0.25, 1, 0.5, 1);
            --smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.light-mode {
            --bg-base: #e2e8f0;
            --bg-gradient: radial-gradient(circle at center, #f1f5f9 0%, #cbd5e1 70%);
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(0, 0, 0, 0.06);
            --text-main: #0f172a;
            --text-dim: #64748b;
            --accent: #2563eb;
            --accent-glow: rgba(37, 99, 235, 0.3);
            --card-bg: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-font-smoothing: antialiased; outline: none; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-base);
            color: var(--text-main);
            overflow: hidden;
            height: 100vh; width: 100vw;
            display: flex; flex-direction: column;
            transition: color 0.5s, background-color 0.5s;
        }

        /* --- BACKGROUND --- */
        #bg-wrapper { position: absolute; inset: 0; z-index: -2; overflow: hidden; background-size: cover; background-position: center; transition: 0.5s; }
        #bg-default { position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: var(--bg-gradient); animation: bgSpin 120s linear infinite; }
        #bg-orb {
            position: absolute; top: 50%; left: 50%; width: 800px; height: 800px;
            background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
            transform: translate(-50%, -50%); filter: blur(80px); opacity: 0.4;
            animation: orbPulse 10s ease-in-out infinite; pointer-events: none;
        }
        @keyframes bgSpin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes orbPulse { 0%, 100% { opacity: 0.4; transform: scale(1); } 50% { opacity: 0.6; transform: scale(1.2); } }

        /* --- INTERFACE --- */
        #main-interface { opacity: 0; pointer-events: none; transition: opacity 0.8s var(--smooth); width: 100%; height: 100%; display: flex; flex-direction: column; }
        #main-interface.unlocked { opacity: 1; pointer-events: auto; }

        /* --- PILL UI OOBE --- */
        #oobe-overlay {
            position: fixed; inset: 0; background: var(--bg-base); z-index: 10000; display: none;
            align-items: center; justify-content: center; transition: opacity 0.5s var(--smooth);
            backdrop-filter: blur(20px);
        }
        
        .pill-container {
            background: var(--card-bg);
            border: 1px solid var(--glass-border);
            width: 480px;
            max-width: 90%;
            border-radius: 40px; /* Pill Shape */
            padding: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.5);
            display: flex; flex-direction: column; align-items: center;
            transform: scale(0.9) translateY(20px); opacity: 0;
            transition: 0.5s var(--fluid);
        }
        
        #oobe-overlay.active .pill-container {
            transform: scale(1) translateY(0); opacity: 1;
        }

        .pill-header {
            font-size: 2rem; font-weight: 800; margin-bottom: 10px;
            background: linear-gradient(to right, var(--text-main), var(--accent));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        
        .pill-header .handwriting {
            font-family: 'Caveat', cursive;
            font-size: 3.5rem;
            line-height: 1;
            color: var(--text-main);
            display: inline-block;
            white-space: nowrap;
            overflow: hidden;
            animation: typing 2s steps(7, end), blink-caret .75s step-end infinite;
            border-right: 3px solid var(--accent);
            margin-bottom: 10px;
        }
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--accent); }
        }


        .pill-desc { text-align: center; color: var(--text-dim); margin-bottom: 25px; font-size: 0.9rem; }

        /* --- MODALS --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px);
            z-index: 11000; display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: 0.4s ease;
        }
        .modal-overlay.active { opacity: 1; pointer-events: auto; }
        .modal-box {
            background: var(--card-bg); border: 1px solid var(--glass-border); border-radius: 32px;
            padding: 30px; width: 500px; max-width: 90%; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transform: scale(0.8) translateY(50px); transition: 0.4s var(--fluid);
            display: flex; flex-direction: column; max-height: 85vh;
        }
        .modal-overlay.active .modal-box { transform: scale(1) translateY(0); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-size: 1.5rem; font-weight: 700; color: var(--text-main); }

        /* Spoof Grid */
        .spoof-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 10px; overflow-y: auto; padding: 5px; width: 100%; }
        .spoof-item {
            background: rgba(125,125,125,0.1); border-radius: 16px; padding: 12px; cursor: pointer;
            display: flex; flex-direction: column; align-items: center; gap: 8px; transition: 0.3s var(--fluid); border: 1px solid transparent;
        }
        .spoof-item:hover { background: rgba(125,125,125,0.2); transform: scale(1.05); }
        .spoof-item.selected { border-color: var(--accent); background: var(--accent-glow); }
        .spoof-icon { width: 32px; height: 32px; border-radius: 6px; }
        .spoof-name { font-size: 0.7rem; color: var(--text-dim); text-align: center; font-weight: 500; }

        /* --- TOP BAR --- */
        .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; z-index: 50; }
        .nav-pill {
            display: flex; gap: 5px; background: var(--glass-bg); padding: 5px;
            border-radius: 100px; border: 1px solid var(--glass-border); backdrop-filter: var(--glass-blur);
        }
        .nav-item {
            padding: 8px 24px; border-radius: 20px; cursor: pointer; font-weight: 500; font-size: 0.9rem;
            color: var(--text-dim); transition: 0.3s;
        }
        .nav-item:hover { color: var(--text-main); background: rgba(125,125,125,0.1); }
        .nav-item.active { background: rgba(125,125,125,0.2); color: var(--text-main); }

        /* --- TRAY & CLOCK --- */
        .system-tray { display: flex; align-items: center; gap: 15px; position: relative; }
        .tray-item {
            background: var(--glass-bg); border: 1px solid var(--glass-border); backdrop-filter: var(--glass-blur);
            color: var(--text-main); height: 44px; display: flex; align-items: center; justify-content: center;
            border-radius: 22px; transition: 0.4s var(--fluid); cursor: pointer;
        }
        .tray-item:hover { transform: scale(1.1); background: rgba(125,125,125,0.2); }
        .clock { padding: 0 20px; font-variant-numeric: tabular-nums; font-weight: 600; min-width: 80px; }

        /* --- NOTIFICATION CENTER & WIDGETS --- */
        #widget-container {
            position: absolute;
            top: 80px;
            right: 40px;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: flex-end;
        }

        .widget {
            width: 380px;
            max-height: 500px;
            background: var(--card-bg);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(12px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            border-radius: 24px;
            transform-origin: top right;
            transform: scale(0.95) translateY(-10px) translateX(10px);
            opacity: 0;
            pointer-events: none;
            transition: 0.4s var(--fluid);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .widget.active {
            transform: scale(1) translateY(0) translateX(0);
            opacity: 1;
            pointer-events: auto;
        }

        .widget-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(125,125,125,0.05);
        }
        .widget-title { font-weight: 700; font-size: 0.95rem; }

        .widget-body {
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .widget-body::-webkit-scrollbar { display: none; }

        /* Notification Specific */
        .notif-card {
            background: rgba(125,125,125,0.05); border: 1px solid var(--glass-border);
            border-radius: 16px; padding: 20px; font-size: 0.9rem; line-height: 1.5;
            color: var(--text-dim); transition: 0.2s;
        }
        .notif-card:hover { background: rgba(125,125,125,0.08); }
        .notif-card h1, .notif-card h2 {
            color: var(--text-main); font-weight: 700; border-bottom: 1px solid var(--glass-border);
            padding-bottom: 8px; margin-bottom: 12px;
        }
        .notif-card h3 {
            color: var(--accent); font-weight: 600; font-size: 0.8rem; letter-spacing: 1px;
            text-transform: uppercase; margin-top: 20px; margin-bottom: 10px;
        }
        .notif-card p { margin-bottom: 10px; }
        .notif-card a { color: var(--accent); text-decoration: none; }
        .notif-card code { background: rgba(0,0,0,0.3); padding: 2px 5px; border-radius: 4px; font-family: monospace; }
        .notif-loading { text-align: center; padding: 20px; color: var(--accent); }
        .notif-card ul { list-style: none; margin-left: 5px; margin-bottom: 15px; }
        .notif-card li { margin-bottom: 8px; position: relative; padding-left: 20px; }
        .notif-card li::before { content: 'â€¢'; color: var(--accent); position: absolute; left: 0; top: 0; }
        .sys-alert { border-left: 4px solid var(--accent); background: var(--accent-glow); color: white; }

        /* To-Do Specific */
        #todo-widget { width: 340px; }
        #todo-widget .widget-body { padding: 20px; }

        .todo-input-group { display: flex; gap: 8px; margin-bottom: 15px; }
        .todo-input-group input {
            background: rgba(125,125,125,0.1); border: none;
            padding: 10px 14px; border-radius: 12px;
            color: var(--text-main); font-size: 0.9rem;
        }
        .todo-input-group input[type=text] { flex: 1; }
        .todo-input-group input[type=time] {
            width: 100px; color: var(--text-dim); cursor: pointer;
        }
        .todo-input-group input[type=time]::-webkit-calendar-picker-indicator {
            filter: invert(1) opacity(0.5); cursor: pointer;
        }
        #add-todo-btn {
            width: 44px; height: 44px; padding: 0;
            flex-shrink: 0;
        }

        #todo-list { list-style: none; max-height: 280px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .todo-item {
            display: flex; align-items: center; padding: 12px; background: rgba(125,125,125,0.05);
            border-radius: 12px; border: 1px solid transparent; transition: 0.3s;
            transform: scale(1);
        }
        .todo-item:hover { background: rgba(125,125,125,0.1); border-color: var(--glass-border); }

        .todo-item.done {
            opacity: 0.5;
            text-decoration: line-through;
        }
        .todo-item.done .todo-text { color: var(--text-dim); }

        .todo-marker {
            width: 20px; height: 20px; border-radius: 50%; margin-right: 12px; flex-shrink: 0;
            border: 2px solid var(--accent); cursor: pointer;
            transition: 0.3s;
        }
        .todo-item.done .todo-marker { background: var(--accent); border-color: var(--accent); }

        .todo-content { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .todo-text {
            font-size: 0.9rem; color: var(--text-main);
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            transition: color 0.3s;
        }
        .todo-time { font-size: 0.7rem; color: var(--accent); margin-top: 2px; }

        .todo-del {
            color: var(--text-dim); cursor: pointer; opacity: 0; padding: 5px;
            transition: 0.3s;
        }
        .todo-item:hover .todo-del { opacity: 0.7; }
        .todo-del:hover { opacity: 1; color: #ef4444; transform: scale(1.2); }
        .todo-empty { text-align: center; color: var(--text-dim); padding: 20px; font-size: 0.9rem; }

        /* --- VIEWPORT --- */
        .view-container { flex: 1; position: relative; width: 100%; display: flex; overflow: hidden; }
        .content-view {
            position: absolute; inset: 0; opacity: 0; visibility: hidden; transform: scale(0.96) translateY(20px);
            transition: opacity 0.4s ease, transform 0.4s var(--fluid), visibility 0.4s; display: flex; flex-direction: column;
        }
        .content-view.active-view { opacity: 1; visibility: visible; transform: scale(1) translateY(0); z-index: 10; }

        /* --- GAMES HERO --- */
        #games-view { justify-content: flex-end; padding-bottom: 0; }
        .hero-area { padding: 0 60px 4vh 60px; max-width: 1200px; margin-bottom: auto; margin-top: 6vh; display: flex; flex-direction: column; justify-content: center; }
        .hero-title {
            font-size: clamp(3rem, 7vh, 6rem); font-weight: 800; line-height: 1.0; margin-bottom: 20px;
            background: linear-gradient(180deg, var(--text-main), var(--text-dim)); -webkit-background-clip: text;
            -webkit-text-fill-color: transparent; opacity: 0; animation: fadeUp 0.8s var(--fluid) forwards 0.3s;
        }
        .games-container {
            width: 100%; height: 52vh; min-height: 320px; background: linear-gradient(to top, var(--bg-base), transparent);
            backdrop-filter: var(--glass-blur); display: flex; align-items: center; opacity: 0; animation: fadeIn 1s ease forwards 0.6s;
        }
        .carousel-track { display: flex; gap: 30px; padding: 0 100px; overflow-x: auto; scroll-behavior: smooth; width: 100%; height: 100%; align-items: center; scrollbar-width: none; }
        .carousel-track::-webkit-scrollbar { display: none; }

        /* --- GAME CARD --- */
        .game-card { min-width: 240px; height: 340px; border-radius: 24px; position: relative; cursor: pointer; perspective: 1000px; }
        .card-inner {
            width: 100%; height: 100%; border-radius: 24px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1);
            background: var(--card-bg); box-shadow: 0 15px 35px rgba(0,0,0,0.3); transition: transform 0.1s linear; position: relative;
        }
        .card-inner img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s var(--fluid), filter 0.5s; filter: brightness(0.8); }
        .game-card:hover .card-inner { box-shadow: 0 0 30px var(--accent-glow); border-color: rgba(255,255,255,0.3); }
        .game-card:hover img { transform: scale(1.1); filter: brightness(1); }
        .card-title {
            position: absolute; bottom: 20px; left: 20px; font-weight: 700; font-size: 1.2rem; color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.9); opacity: 0; transform: translateY(10px); transition: 0.3s; pointer-events: none;
        }
        .game-card:hover .card-title { opacity: 1; transform: translateY(0); }

        .card-del-btn {
            position: absolute; top: -10px; right: -10px; width: 30px; height: 30px;
            background: #ef4444; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 14px; opacity: 0; transform: scale(0.5); transition: 0.3s var(--fluid); z-index: 20;
            box-shadow: 0 4px 10px rgba(239, 68, 68, 0.5);
        }
        .game-card:hover .card-del-btn { opacity: 1; transform: scale(1); top: -10px; right: -10px; }
        .card-del-btn:hover { transform: scale(1.2) rotate(90deg); background: #dc2626; }

        .add-tile .card-inner { display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(125,125,125,0.05); }
        .add-icon { font-size: 3rem; color: var(--text-dim); transition: 0.4s var(--fluid); }
        .add-tile:hover .add-icon { color: var(--accent); transform: scale(1.3); }
        
        /* New Badge (Modern & Animated) */
        .new-badge {
            position: absolute; top: 12px; right: 12px;
            background: linear-gradient(45deg, #22c55e, #16a34a);
            color: #ffffff;
            font-weight: 700; font-size: 0.7rem; letter-spacing: 0.5px;
            padding: 6px 12px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
            z-index: 5;
            text-transform: uppercase;
            transform: rotate(10deg) scale(0.9);
            transform-origin: top right;
            transition: transform 0.3s var(--fluid);
        }
        .game-card:hover .new-badge {
            transform: rotate(0deg) scale(1);
        }

        /* --- SETTINGS --- */
        #settings-view { align-items: center; justify-content: center; background: rgba(0,0,0,0.2); }
        .settings-box { 
            width: 700px; max-height: 80vh; padding: 0; 
            overflow-y: auto; background: var(--card-bg); border-radius: 30px; 
            border: 1px solid var(--glass-border); box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            scrollbar-width: none; -ms-overflow-style: none;
        }
        .settings-box::-webkit-scrollbar { display: none; }

        .st-header {
            padding: 30px 40px; border-bottom: 1px solid rgba(125,125,125,0.1);
            display: flex; justify-content: space-between; align-items: center;
            background: var(--card-bg); position: sticky; top: 0; z-index: 5;
        }
        .st-body { padding: 40px; }
        
        .st-group { 
            background: rgba(125,125,125,0.03); border: 1px solid rgba(125,125,125,0.1); 
            border-radius: 20px; padding: 20px; margin-bottom: 20px; 
        }
        .st-group h3 { 
            margin-bottom: 15px; color: var(--accent); font-size: 0.75rem; 
            letter-spacing: 1.5px; text-transform: uppercase; font-weight: 700;
        }

        .control-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .control-row:last-child { margin-bottom: 0; }
        
        .st-input {
            background: rgba(125,125,125,0.1); border: 1px solid var(--glass-border);
            color: var(--text-main); padding: 8px 15px; border-radius: 10px; width: 220px;
        }
        .switch { position: relative; width: 42px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; inset: 0; background-color: rgba(125,125,125,0.3); transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s var(--fluid); border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(18px); }

        .range-slider { width: 100%; -webkit-appearance: none; background: rgba(125,125,125,0.2); height: 6px; border-radius: 3px; }
        .range-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; background: var(--accent); cursor: pointer; transition: 0.2s; }
        .range-slider::-webkit-slider-thumb:hover { transform: scale(1.3); }

        .btn {
            padding: 10px 20px; border-radius: 12px; font-weight: 600; text-decoration: none;
            transition: all 0.3s var(--fluid); display: inline-flex; align-items: center; justify-content: center;
            font-size: 0.9rem; cursor: pointer; border: none;
        }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 10px 20px var(--accent-glow); }
        .btn-danger { background: rgba(220, 38, 38, 0.1); color: #ef4444; border: 1px solid rgba(220, 38, 38, 0.2); }
        .btn-danger:hover { background: rgba(220, 38, 38, 0.2); color: #fff; }
        .btn-ghost { background: transparent; color: var(--text-dim); border: 1px solid var(--glass-border); }
        .btn-ghost:hover { background: rgba(125,125,125,0.1); color: var(--text-main); }
        
        .beta-btn {
            font-size: 0.75rem; padding: 6px 12px; background: rgba(125,125,125,0.15); 
            color: var(--text-dim); text-decoration: none; border-radius: 8px; border: 1px solid var(--glass-border);
            transition: 0.2s; display: inline-flex; align-items: center;
        }
        .beta-btn:hover { background: var(--accent); color: white; border-color: var(--accent); }

        .scroll-arrow {
            position: absolute; top: 50%; transform: translateY(-50%); width: 50px; height: 50px; border-radius: 50%;
            background: rgba(125,125,125,0.1); display: flex; justify-content: center; align-items: center;
            cursor: pointer; z-index: 100; transition: 0.3s; backdrop-filter: blur(10px);
        }
        .scroll-arrow:hover { background: var(--text-main); color: var(--bg-base); }
        .scroll-arrow.left { left: 30px; } .scroll-arrow.right { right: 30px; }

        @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
        @keyframes fadeUp { from{opacity:0; transform:translateY(30px);} to{opacity:1; transform:translateY(0);} }

        /* --- FLOATING MUSIC WINDOW --- */
        #music-window {
            position: absolute; top: 50%; left: 50%; width: 950px; height: 650px;
            --scale: 0.9;
            --drag-x: 0px;
            --drag-y: 0px;
            transform: translate(-50%, -50%) translate(var(--drag-x), var(--drag-y)) scale(var(--scale));
            opacity: 0; pointer-events: none;
            background: #000; border-radius: 30px; overflow: hidden;
            box-shadow: 0 40px 100px rgba(0,0,0,0.8), 0 0 0 1px rgba(255,59,59,0.2);
            z-index: 9999; display: flex; flex-direction: column; resize: both; min-width: 600px; min-height: 400px;
            transition: opacity 0.4s ease, transform 0.4s var(--fluid);
        }
        #music-window.active {
            opacity: 1;
            --scale: 1;
            pointer-events: auto;
        }
        
        /* When dragging, remove transition to prevent lag */
        #music-window.dragging { transition: none; }

        .win-header {
            height: 40px; background: rgba(46, 52, 64, 0.9);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; cursor: grab; border-bottom: 1px solid rgba(255, 59, 59, 0.2);
        }
        .win-header:active { cursor: grabbing; }
        .win-title { font-size: 0.8rem; font-weight: 700; color: #eceff4; text-transform: uppercase; letter-spacing: 2px; }
        .win-close { color: #bf616a; cursor: pointer; font-size: 1.5rem; transition: 0.2s; line-height: 0; }
        .win-close:hover { color: #ff3b3b; transform: scale(1.2); }
        
        .win-content { flex: 1; position: relative; width: 100%; height: 100%; background: #000; }
        iframe#music-frame { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>

    <!-- OOBE LAYER (Pill UI) -->
    <div id="oobe-overlay">
        <div class="pill-container">
            <div class="pill-header">NexusXOS 13 RC</div>
            <div class="pill-desc">Select a Tab Cloak to begin your session.</div>
            
            <!-- In-Pill Spoof Grid -->
            <div class="spoof-grid" id="oobe-spoof-grid" style="max-height: 200px; margin-bottom: 25px;"></div>
            
            <button class="btn btn-primary" style="width:100%" onclick="OOBE.finish()">Enter System</button>
        </div>
    </div>

    <!-- SPOOF MODAL (Settings) -->
    <div id="spoof-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">Tab Cloak</span>
                <button class="btn btn-danger" style="padding:6px 12px;" onclick="Modals.close('spoof-modal')">Close</button>
            </div>
            <div class="spoof-grid" id="settings-spoof-grid"></div>
        </div>
    </div>

    <!-- ADD APP MODAL -->
    <div id="add-game-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">Add Custom App</span>
                <button class="btn btn-danger" style="padding:6px 12px;" onclick="Modals.close('add-game-modal')">Cancel</button>
            </div>
            <div style="display:flex; flex-direction:column; gap:15px;">
                <input type="text" class="st-input" id="ag-title" placeholder="App Name (e.g., Minecraft)" style="width:100%">
                <input type="text" class="st-input" id="ag-url" placeholder="URL (e.g., https://game.com)" style="width:100%">
                
                <div style="display:flex; gap:10px; margin-top:5px;">
                    <button class="btn btn-ghost" onclick="AddGame.setType('favicon')" id="btn-fav">Use Favicon</button>
                    <button class="btn btn-ghost" onclick="AddGame.setType('image')" id="btn-img">Custom Image</button>
                </div>

                <div id="ag-img-input-container" style="display:none; flex-direction:column; gap:10px;">
                     <input type="text" class="st-input" id="ag-img-url" placeholder="Image URL" style="width:100%">
                     <div style="text-align:center; font-size:0.8rem; color:var(--text-dim)">OR</div>
                     <input type="file" id="ag-file" accept="image/*" style="color:var(--text-dim)">
                </div>
                <button class="btn btn-primary" style="margin-top:10px;" onclick="AddGame.save()">Add to Library</button>
            </div>
        </div>
    </div>

    <!-- CHANGELOG MODAL -->
    <div id="changelog-modal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">Changelog</span>
                <button class="btn btn-danger" style="padding:6px 12px;" onclick="Modals.close('changelog-modal')">Close</button>
            </div>
            <div class="nc-body" id="changelog-content" style="max-height: 60vh; padding-right: 15px;">
                <div class="notif-loading">Loading Changelog...</div>
            </div>
        </div>
    </div>

    <!-- BACKGROUND -->
    <div id="bg-wrapper"><div id="bg-default"></div></div>
    <div id="bg-orb"></div>

    <!-- MAIN INTERFACE -->
    <div id="main-interface">
        <div class="top-bar">
            <div class="nav-pill">
                <div class="nav-item active" data-view="games">Library</div>
                <div class="nav-item" data-view="settings">Settings</div>
            </div>
            <div class="system-tray">
                <div class="clock tray-item" id="clock"></div>

                <!-- ICONS -->
                <div class="tray-item icon-btn" data-action="toggle-music">
                    <i data-lucide="music"></i>
                </div>
                <div class="tray-item icon-btn" data-action="toggle-notifications">
                    <i data-lucide="bell"></i>
                </div>
                <div class="tray-item icon-btn" data-action="toggle-fullscreen">
                    <i data-lucide="maximize"></i>
                </div>
            </div>
        </div>

        <!-- POP-UP WIDGETS -->
        <div id="widget-container">
            <!-- NOTIFICATION CENTER -->
            <div id="notification-center" class="widget">
                <div class="widget-header">
                    <span class="widget-title">Notifications</span>
                    <button class="btn btn-ghost" data-action="reload-notifications">Refresh</button>
                </div>
                <div class="widget-body" id="notif-content">
                    <div class="notif-loading">Loading Updates...</div>
                </div>
            </div>

            <!-- TODO WIDGET (Refactored) -->
            <div id="todo-widget" class="widget">
                <div class="widget-header">
                    <span class="widget-title">To-Do List</span>
                </div>
                <div class="widget-body">
                    <div class="todo-input-group">
                        <input type="text" id="todo-input" placeholder="Add a task...">
                        <input type="time" id="todo-time" title="Set a reminder time">
                        <button id="add-todo-btn" class="btn-primary"><i data-lucide="plus"></i></button>
                    </div>
                    <ul id="todo-list"></ul>
                </div>
            </div>
        </div>

        <div class="view-container">
            <!-- LIBRARY -->
            <div id="games-view" class="content-view active-view">
                <div class="hero-area">
                    <div class="hero-title" id="hero-text">Select App</div>
                    <div class="hero-actions" style="opacity:0; animation:fadeIn 1s forwards 0.5s;">
                        <a href="#" target="_blank" id="play-btn" class="btn btn-primary">Launch</a>
                    </div>
                </div>
                <div class="games-container">
                    <div class="scroll-arrow left" onclick="Games.scroll(-1)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg></div>
                    <div class="scroll-arrow right" onclick="Games.scroll(1)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg></div>
                    <div class="carousel-track" id="card-track"></div>
                </div>
            </div>

            <!-- SETTINGS -->
            <div id="settings-view" class="content-view">
                <div class="settings-box">
                    <div class="st-header">
                        <h2>Control Center</h2>
                        <a href="https://ormsescaperoad.w3spaces.com/beta.html" class="beta-btn">Go to Beta <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px; margin-left:5px;"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg></a>
                    </div>
                    
                    <div class="st-body">
                        <div class="st-group">
                            <h3>Visuals</h3>
                            <div class="control-row">
                                <span>Light Mode</span>
                                <label class="switch"><input type="checkbox" id="theme-toggle" onchange="Settings.toggleTheme()"><span class="slider"></span></label>
                            </div>
                            <div class="control-row">
                                <span>Background URL</span>
                                <input type="text" class="st-input" id="bg-input" placeholder="https://..." onchange="Settings.setBg(this.value)">
                            </div>
                            <div class="control-row">
                                <span>Tab Cloak</span>
                                <button class="btn btn-ghost" onclick="Modals.open('spoof-modal')">Change</button>
                            </div>
                            <div class="control-row" style="flex-direction:column; align-items:flex-start; gap:10px; margin-top:15px;">
                                <span>3D Tilt Intensity: <span id="tilt-val" style="color:var(--accent)">500</span></span>
                                <input type="range" min="0" max="1000" value="500" class="range-slider" oninput="Settings.setTilt(this.value)">
                            </div>
                        </div>

                        <div class="st-group">
                            <h3>System</h3>
                            <div class="control-row">
                                <span>24-Hour Time</span>
                                <label class="switch"><input type="checkbox" id="time-toggle" onchange="Settings.toggleTime()"><span class="slider"></span></label>
                            </div>
                            <div class="control-row">
                                <span>Anti-Close</span>
                                <label class="switch"><input type="checkbox" id="ptc-toggle" onchange="Settings.togglePrevent()"><span class="slider"></span></label>
                            </div>
                        </div>

                        <div class="st-group">
                            <h3>Data & Reset</h3>
                            <div class="control-row">
                                <span>Factory Reset</span>
                                <button class="btn btn-danger" onclick="OOBE.reset()">Reset</button>
                            </div>
                             <div class="control-row">
                                <span>View Changelog</span>
                                <button class="btn btn-ghost" onclick="Changelog.open()">View</button>
                            </div>
                            <button class="btn btn-primary" style="width:100%; margin-top:15px;" onclick="Utils.openBlank()">Launch in about:blank</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- CUSTOM DRAGGABLE MUSIC WINDOW -->
    <div id="music-window">
        <div class="win-header" id="mw-header">
            <div class="win-title">NexusX Player</div>
            <div class="win-close" onclick="MusicApp.toggle()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg></div>
        </div>
        <div class="win-content">
            <iframe id="music-frame"></iframe>
        </div>
    </div>

    <script>
        class NexusApp {
            constructor() {
                this.state = {
                    version: "13 RC",
                    oobeKey: "nx_oobe_v13",
                    settings: this.loadSettings(),
                    lastNotif: null,
                };

                this.constants = {
                    defaultGames: [
                        { title: "Froggies Arcade", url: "https://frogs.look.good.pxi-fusion.com.cdn.cloudflare.net/math/", image: "https://images.unsplash.com/photo-1590005176489-db2e714711fc?q=80&w=1000", isNew: true },
                        { title: "GNMath V2", url: "https://ormsescaperoad.w3spaces.com/gnmath.html", image: "https://images.unsplash.com/photo-1648700231913-ad061d9b3ec9?w=1920", isNew: true },
                        { title: "BitLife", url: "https://ormsescaperoad.w3spaces.com/bitlife.html", image: "https://images.unsplash.com/photo-1563207153-f403bf289096?q=80&w=1000&auto=format&fit=crop", isNew: true },
                        { title: "Snow Rider 3D", url: "https://ormsescaperoad.w3spaces.com/snow.html", image: "https://plus.unsplash.com/premium_photo-1719930221794-0680e7fd8071", isNew: true },
                        { title: "Oregon Trail", url: "https://oregontrail.ws/the-oregon-trail-game/", image: "https://images.unsplash.com/photo-1533167649158-6d508895b680?q=80&w=1000", isNew: true },
                        { title: "Mesh", url: "https://me.meshcapade.com/editor", image: "https://images.unsplash.com/photo-1558591710-4b4a1ae0f04d?q=80&w=1000", isNew: true },
                        { title: "Willway", url: "https://admin.internetspeedtest.world/", image: "https://images.unsplash.com/photo-1551703599-6b3e8379aa8b?q=80&w=1000", isNew: true },
                        { title: "FC Games", url: "https://agreeable-mud-098a6b110.1.azurestaticapps.net/", image: "https://images.unsplash.com/photo-1550745165-9bc0b252726f?q=80&w=1000", isNew: true },
                        { title: "Silk", url: "https://ormsescaperoad.w3spaces.com/silk.html", image: "https://images.unsplash.com/photo-1502691876148-a84978e59af8?q=80&w=1000" },
                        { title: "Snake", url: "https://ormsescaperoad.w3spaces.com/snake.html", image: "https://images.unsplash.com/photo-1739869610059-86fabc7bcd7b?fit=clip&w=2500" },
                        { title: "Tetris", url: "https://ormsescaperoad.w3spaces.com/tetris.html", image: "https://images.unsplash.com/vector-1753382303802-7d317d852293?w=1920"},
                        { title: "Hex", url: "https://www.nddb.coop/ccnddb/games/Hexagon Twist/", image: "https://images.unsplash.com/vector-1761047846560-52720ea86a46?w=1920" },
                        { title: "Dino Run", url: "https://ormsescaperoad.w3spaces.com/dino.html", image: "https://images.unsplash.com/vector-1761941086671-a623243d84a3?w=1920" },
                        { title: "Flappy Bird", url: "https://ormsescaperoad.w3spaces.com/bird.html", image: "https://images.unsplash.com/photo-1732198246906-8168ef1ff6bc?q=80&w=1740" },
                        { title: "Drive Mad", url: "https://ormsescaperoad.w3spaces.com/drive-mad.html", image: "https://images.unsplash.com/photo-1763897236977-1baa4a026a6d?q=80&w=2064" },
                        { title: "Bank Heist", url: "https://ormsescaperoad.w3spaces.com/bank.html", image: "https://images.unsplash.com/photo-1738691035045-3fb009e8aa26?fit=clip&w=2500" },
                        { title: "Slither.io", url: "https://ormsescaperoad.w3spaces.com/snakeio.html", image: "https://images.unsplash.com/photo-1736613403120-8d48aebd29e1?fit=clip&w=2500" },
                        { title: "Escape Road", url: "https://ormsescaperoad.w3spaces.com/escape.html", image: "https://images.unsplash.com/photo-1764957080454-dd997a855733?q=80&w=774" },
                    ],
                    spoofs: [
                        { id: 'none', t: 'NexusXOS 13 RC', i: 'https://www.google.com/favicon.ico' },
                        { id: 'google', t: 'Google', i: 'https://www.google.com/favicon.ico' },
                        { id: 'canvas', t: 'Dashboard', i: 'https://du11hjcvx0uqb.cloudfront.net/dist/images/favicon-e10d657a73.ico' },
                        { id: 'clever', t: 'Clever | Portal', i: 'https://assets.clever.com/favicon.ico' },
                        { id: 'classroom', t: 'Classes', i: 'https://ssl.gstatic.com/classroom/favicon.png' },
                        { id: 'drive', t: 'My Drive', i: 'https://ssl.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png' },
                        { id: 'gmail', t: 'Inbox', i: 'https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico' },
                        { id: 'zoom', t: 'Zoom Meeting', i: 'https://st1.zoom.us/zoom.ico' },
                        { id: 'kahoot', t: 'Enter Game PIN!', i: 'https://kahoot.it/favicon.ico' },
                        { id: 'quizlet', t: 'Quizlet', i: 'https://assets.quizlet.com/a/j/favicon-32x32.e762772.png' },
                        { id: 'wikipedia', t: 'Wikipedia', i: 'https://en.wikipedia.org/static/favicon/wikipedia.ico' },
                        { id: 'discord', t: 'Discord', i: 'https://assets-global.website-files.com/6257adef93867e50d84d30e2/636e0a6a49cf127bf92de1e2_icon_clyde_blurple_RGB.png' },
                        { id: 'spotify', t: 'Spotify - Web Player', i: 'https://open.spotifycdn.com/cdn/images/favicon32.b64ecc03.png' },
                        { id: 'reddit', t: 'Reddit', i: 'https://www.redditstatic.com/desktopweb/img/favicon/favicon-32x32.png' },
                        { id: 'twitter', t: 'X', i: 'https://abs.twimg.com/favicons/twitter.3.ico' }
                    ]
                };

                this.ui = new UIManager(this);
                this.clock = new Clock(this);
                this.todo = new Todo(this);
                this.notifications = new Notifications(this);
                this.games = new Games(this);
                this.settings = new Settings(this);
                this.music = new MusicApp(this);
                this.modals = new Modals(this);
                this.addGame = new AddGame(this);
                this.oobe = new OOBE(this);
        class UIManager {
            // ... UIManager methods
            populateSpoofGrids() {
                const grids = [
                    document.getElementById('oobe-spoof-grid'),
                    document.getElementById('settings-spoof-grid')
                ];
                grids.forEach(grid => {
                    if (!grid) return;
                    grid.innerHTML = '';
                    this.app.constants.spoofs.forEach(s => {
                        let d = document.createElement('div');
                        d.className = "spoof-item";
                        d.dataset.id = s.id;
                        d.innerHTML = `<img src="${s.i}" class="spoof-icon"><div class="spoof-name">${s.t}</div>`;
                        d.onclick = () => this.app.settings.setCloak(s.id);
                        grid.appendChild(d);
                    });
                });
            }
        }
        class Games {
            constructor(app) {
                this.app = app;
                this.list = [];
                this.dom = {
                    track: document.getElementById('card-track'),
                    heroText: document.getElementById('hero-text'),
                    playBtn: document.getElementById('play-btn')
                };

                document.querySelector('.scroll-arrow.left').onclick = () => this.scroll(-1);
                document.querySelector('.scroll-arrow.right').onclick = () => this.scroll(1);
            }

            render() {
                this.dom.track.innerHTML = "";
                this.list = [...this.app.constants.defaultGames, ...this.app.state.settings.customGames];
                
                this.list.forEach((g, i) => {
                    let card = document.createElement('div');
                    card.className = "game-card";
                    const isCustom = i >= this.app.constants.defaultGames.length;

                    let html = ``;
                    if (g.isNew) html += `<div class="new-badge">New</div>`;
                    if (isCustom) html += `<div class="card-del-btn"><i data-lucide="trash-2"></i></div>`;

                    html += `<div class="card-inner"><img src="${g.image}" loading="lazy"></div><div class="card-title">${g.title}</div>`;

                    card.innerHTML = html;
                    card.onclick = () => window.open(g.url, '_blank');
                    card.onmouseenter = () => this.updateHero(i);
                    if (isCustom) {
                        card.querySelector('.card-del-btn').onclick = (e) => {
                            e.stopPropagation();
                            this.removeCustom(i - this.app.constants.defaultGames.length);
                        };
                    }
                    this.addTilt(card);
                    this.dom.track.appendChild(card);
                });

                let addTile = document.createElement('div');
                addTile.className = "game-card add-tile";
                addTile.innerHTML = `<div class="card-inner"><div class="add-icon"><i data-lucide="plus"></i></div></div>`;
                addTile.onclick = () => this.app.modals.open('add-game-modal');
                this.addTilt(addTile);
                this.dom.track.appendChild(addTile);

                this.updateHero(0);
                lucide.createIcons();
            }

            updateHero(i) {
                if (!this.list[i]) return;
                this.dom.heroText.style.opacity = 0.5;
                setTimeout(() => {
                    this.dom.heroText.textContent = this.list[i].title;
                    this.dom.heroText.style.opacity = 1;
                }, 100);
                this.dom.playBtn.href = this.list[i].url;
            }

            removeCustom(idx) {
                if (confirm("Remove this app?")) {
                    this.app.state.settings.customGames.splice(idx, 1);
                    this.app.saveSetting('customGames', JSON.stringify(this.app.state.settings.customGames));
                    this.render();
                }
            }

            addTilt(card) {
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const tiltFactor = this.app.state.settings.tilt / 1000;
                    const maxRot = 25;

                    const x = (e.clientX - rect.left - rect.width / 2) / (rect.width / 2);
                    const y = -(e.clientY - rect.top - rect.height / 2) / (rect.height / 2);

                    const rotX = y * maxRot * tiltFactor;
                    const rotY = x * maxRot * tiltFactor;

                    card.querySelector('.card-inner').style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
                });
                card.addEventListener('mouseleave', () => {
                    card.querySelector('.card-inner').style.transform = `rotateX(0) rotateY(0)`;
                });
            }

            scroll(d) {
                this.dom.track.scrollBy({ left: d * 320, behavior: 'smooth' });
            }
        }

        class Settings {
            constructor(app) {
                this.app = app;
                this.dom = {
                    themeToggle: document.getElementById('theme-toggle'),
                    timeToggle: document.getElementById('time-toggle'),
                    ptcToggle: document.getElementById('ptc-toggle'),
                    bgInput: document.getElementById('bg-input'),
                    tiltSlider: document.querySelector('.range-slider'),
                    tiltVal: document.getElementById('tilt-val'),
                    cloakBtn: document.querySelector('button[onclick*="spoof-modal"]'),
                    resetBtn: document.querySelector('button[onclick*="OOBE.reset"]'),
                    changelogBtn: document.querySelector('button[onclick*="Changelog.open"]'),
                    blankBtn: document.querySelector('button[onclick*="Utils.openBlank"]')
                };
                this.initListeners();
            }

            initListeners() {
                this.dom.themeToggle.onchange = () => this.toggleTheme();
                this.dom.timeToggle.onchange = () => this.toggleTime();
                this.dom.ptcToggle.onchange = () => this.togglePrevent();
                this.dom.bgInput.onchange = (e) => this.setBg(e.target.value);
                this.dom.tiltSlider.oninput = (e) => this.setTilt(e.target.value);
                this.dom.cloakBtn.onclick = () => this.app.modals.open('spoof-modal');
                this.dom.resetBtn.onclick = () => { if (confirm("Reset Everything?")) { localStorage.clear(); location.reload(); } };
                this.dom.changelogBtn.onclick = () => this.app.modals.open('changelog-modal');
                this.dom.blankBtn.onclick = () => this.openBlank();
            }

            applyAll() {
                this.dom.themeToggle.checked = this.app.state.settings.lightMode;
                this.dom.timeToggle.checked = this.app.state.settings.time24;
                this.dom.ptcToggle.checked = this.app.state.settings.preventClose;
                this.dom.bgInput.value = this.app.state.settings.bg;
                this.dom.tiltVal.innerText = this.app.state.settings.tilt;
                this.dom.tiltSlider.value = this.app.state.settings.tilt;

                if (this.app.state.settings.lightMode) document.body.classList.add('light-mode');
                this.setBg(this.app.state.settings.bg);
            }

            toggleTheme() { this.app.saveSetting('lightMode', !this.app.state.settings.lightMode); document.body.classList.toggle('light-mode'); }
            toggleTime() { this.app.saveSetting('time24', !this.app.state.settings.time24); this.app.clock.update(); }
            togglePrevent() { this.app.saveSetting('preventClose', !this.app.state.settings.preventClose); }
            setBg(url) {
                this.app.saveSetting('bg', url);
                const wrap = document.getElementById('bg-wrapper');
                if (url && url.trim() !== "") {
                    wrap.style.backgroundImage = `url('${url}')`;
                    document.getElementById('bg-default').style.opacity = 0;
                } else {
                    wrap.style.backgroundImage = 'none';
                    document.getElementById('bg-default').style.opacity = 1;
                }
            }
            setTilt(val) { this.app.saveSetting('tilt', val); this.dom.tiltVal.innerText = val; }
            setCloak(id) {
                this.app.saveSetting('cloak', id);
                const s = this.app.constants.spoofs.find(x => x.id === id) || this.app.constants.spoofs[0];
                document.title = s.t;
                document.getElementById('favicon').href = s.i;
                document.querySelectorAll('.spoof-item').forEach(el => el.classList.toggle('selected', el.dataset.id === id));
            }
            openBlank() {
                let win = window.open();
                win.document.body.style.margin="0"; win.document.body.style.height="100vh";
                let iframe = win.document.createElement('iframe');
                iframe.style.cssText = "border:none; width:100%; height:100%;";
                iframe.src = window.location.href;
                win.document.body.appendChild(iframe);
            }
        }

        class Modals {
            constructor(app) {
                this.app = app;
                this.changelogLoaded = false;
                document.querySelectorAll('.modal-overlay .btn-danger').forEach(btn => {
                    btn.onclick = () => this.close(btn.closest('.modal-overlay').id);
                });
            }
            open(id) {
                document.getElementById(id).classList.add('active');
                if (id === 'changelog-modal' && !this.changelogLoaded) {
                    this.loadChangelog();
                }
            }
            close(id) { document.getElementById(id).classList.remove('active'); }

            loadChangelog() {
                const content = document.getElementById('changelog-content');
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                const targetUrl = 'https://pastebin.com/raw/6zCTDTmj';

                fetch(proxyUrl + encodeURIComponent(targetUrl))
                    .then(r => {
                        if (!r.ok) throw new Error('Network error');
                        return r.text();
                    })
                    .then(text => {
                        content.innerHTML = `<div class="notif-card">${marked.parse(text)}</div>`;
                        this.changelogLoaded = true;
                    })
                    .catch(e => {
                        content.innerHTML = `<div class="notif-card" style="color:#ef4444"><strong>Fetch Error</strong><p>Failed to load changelog.</p></div>`;
                    });
            }
        }

        class OOBE {
            constructor(app) {
                this.app = app;
                this.dom = {
                    overlay: document.getElementById('oobe-overlay'),
                    header: document.querySelector('#oobe-overlay .pill-header'),
                    grid: document.getElementById('oobe-spoof-grid'),
                    finishBtn: document.querySelector('#oobe-overlay .btn-primary')
                };
                this.initListeners();
            }

            initListeners() {
                this.dom.finishBtn.onclick = () => this.finish();
            }

            init() {
                if (!localStorage.getItem(this.app.state.oobeKey)) {
                    this.dom.header.innerHTML = '<span class="handwriting">NexusX</span>';
                    this.dom.overlay.style.display = 'flex';
                    setTimeout(() => this.dom.overlay.classList.add('active'), 50);
                } else {
                    document.getElementById('main-interface').classList.add('unlocked');
                }
            }

            finish() {
                localStorage.setItem(this.app.state.oobeKey, 'true');
                this.dom.overlay.classList.remove('active');
                setTimeout(() => {
                    this.dom.overlay.style.display = 'none';
                    document.getElementById('main-interface').classList.add('unlocked');
                }, 800);
            }
        }
        class AddGame {
            constructor(app) {
                this.app = app;
                this.type = 'favicon';
                this.dom = {
                    title: document.getElementById('ag-title'),
                    url: document.getElementById('ag-url'),
                    imgUrl: document.getElementById('ag-img-url'),
                    file: document.getElementById('ag-file'),
                    btnFav: document.getElementById('btn-fav'),
                    btnImg: document.getElementById('btn-img'),
                    imgContainer: document.getElementById('ag-img-input-container'),
                    saveBtn: document.querySelector('#add-game-modal .btn-primary')
                };
                this.initListeners();
            }

            initListeners() {
                this.dom.btnFav.onclick = () => this.setType('favicon');
                this.dom.btnImg.onclick = () => this.setType('image');
                this.dom.saveBtn.onclick = () => this.save();
            }

            setType(t) {
                this.type = t;
                this.dom.btnFav.style.background = t === 'favicon' ? 'rgba(59,130,246,0.2)' : 'transparent';
                this.dom.btnImg.style.background = t === 'image' ? 'rgba(59,130,246,0.2)' : 'transparent';
                this.dom.imgContainer.style.display = t === 'image' ? 'flex' : 'none';
            }

            async save() {
                const title = this.dom.title.value;
                const url = this.dom.url.value;
                if (!title || !url) return alert("Required fields missing");

                let img = "";
                if (this.type === 'favicon') {
                    let d = url.replace('http://','').replace('https://','').split(/[/?#]/)[0];
                    img = `https://www.google.com/s2/favicons?domain=${d}&sz=128`;
                } else {
                    const iUrl = this.dom.imgUrl.value;
                    const file = this.dom.file.files[0];
                    if (iUrl) img = iUrl;
                    else if (file) {
                        try { img = await this.getBase64(file); } catch (e) { return alert("Image Error"); }
                    } else return alert("Image required");
                }

                this.app.state.settings.customGames.push({ title, url, image: img });
                this.app.saveSetting('customGames', JSON.stringify(this.app.state.settings.customGames));
                this.app.games.render();
                this.app.modals.close('add-game-modal');
                this.dom.title.value = ""; this.dom.url.value = "";
            }

            getBase64(file) {
                return new Promise((res, rej) => {
                    const r = new FileReader(); r.readAsDataURL(file);
                    r.onload = () => res(r.result); r.onerror = e => rej(e);
                });
            }
        }
        class Notifications {
            constructor(app) {
                this.app = app;
                this.loaded = false;
                this.dom = {
                    widget: document.getElementById('notification-center'),
                    content: document.getElementById('notif-content')
                };
            }

            isOpen() {
                return this.dom.widget.classList.contains('active');
            }

            toggle() {
                const isActive = this.dom.widget.classList.toggle('active');
                if (isActive && !this.loaded) {
                    this.reload();
                }
            }

            reload() {
                this.dom.content.innerHTML = '<div class="notif-loading">Checking for updates...</div>';
                
                const proxyUrl = 'https://api.allorigins.win/raw?url=';
                const targetUrl = 'https://pastebin.com/raw/6zCTDTmj';

                fetch(proxyUrl + encodeURIComponent(targetUrl))
                    .then(r => {
                        if (!r.ok) throw new Error('Network error');
                        return r.text();
                    })
                    .then(text => {
                        const newNotifId = text.substring(0, 50); // Use first 50 chars as a unique ID

                        if (newNotifId !== this.app.state.settings.lastNotifId) {
                            this.app.saveSetting('lastNotifId', newNotifId);
                            if (!this.isOpen()) {
                                this.toggle();
                            }
                        }

                        this.dom.content.innerHTML = `<div class="notif-card">${marked.parse(text)}</div>`;
                        this.loaded = true;
                    })
                    .catch(e => {
                        this.dom.content.innerHTML = `<div class="notif-card" style="color:#ef4444"><strong>Fetch Error</strong><p>Failed to load notifications.</p></div>`;
                    });
            }

            pushLocal(title, msg) {
                const alertHtml = `<div class="notif-card sys-alert"><h3>${title}</h3><p>${msg}</p></div>`;
                this.dom.content.insertAdjacentHTML('afterbegin', alertHtml);
            }
        }

                this.init();
            }

            loadSettings() {
                return {
                    time24: localStorage.getItem('nx_time24') === 'true',
                    preventClose: localStorage.getItem('nx_prevent') === 'true',
                    cloak: localStorage.getItem('nx_cloak') || 'none',
                    bg: localStorage.getItem('nx_bg') || '',
                    todos: JSON.parse(localStorage.getItem('nx_todos') || '[]'),
                    lightMode: localStorage.getItem('nx_light') === 'true',
                    tilt: parseInt(localStorage.getItem('nx_tilt') || '500'),
                    customGames: JSON.parse(localStorage.getItem('nx_custom_games') || '[]'),
                    lastNotifId: localStorage.getItem('nx_last_notif_id') || null
                };
            }

            saveSetting(key, value) {
                localStorage.setItem(key, value);
                this.state.settings[key] = value;
            }

            init() {
                this.ui.initViewport();
                this.settings.applyAll();
                this.games.render();
                this.todo.render();
                this.clock.start();
                this.ui.populateSpoofGrids();
                this.settings.setCloak(this.state.settings.cloak);
                this.oobe.init();
                this.initGlobalListeners();

                lucide.createIcons();
            }

            initGlobalListeners() {
                window.addEventListener('beforeunload', (e) => {
                    if (this.state.settings.preventClose) {
                        e.preventDefault();
                        e.returnValue = '';
                    }
                });
            }
        }
        class UIManager {
            constructor(app) {
                this.app = app;
                document.getElementById('clock').onclick = () => this.app.todo.toggle();
                document.querySelector('[data-action="toggle-notifications"]').onclick = () => this.app.notifications.toggle();
                document.querySelector('[data-action="reload-notifications"]').onclick = () => this.app.notifications.reload();
                document.querySelector('[data-action="toggle-music"]').onclick = () => this.app.music.toggle();
                document.querySelector('[data-action="toggle-fullscreen"]').onclick = () => this.toggleFullscreen();

                document.querySelectorAll('.nav-item').forEach(item => {
                    item.onclick = () => this.setView(item.dataset.view);
                });
            }

            setView(view) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                document.querySelectorAll('.content-view').forEach(c => c.classList.remove('active-view'));

                document.querySelector(`.nav-item[data-view="${view}"]`).classList.add('active');
                document.getElementById(`${view}-view`).classList.add('active-view');
            }

            toggleFullscreen() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen();
                } else {
                    document.exitFullscreen();
                }
            }

            initViewport() {
                if (window.innerWidth < 800) {
                    const meta = document.querySelector('meta[name="viewport"]');
                    if (meta) {
                        meta.setAttribute('content', 'width=device-width, initial-scale=0.1');
                        setTimeout(() => meta.setAttribute('content', 'width=device-width, initial-scale=1.0'), 50);
                    }
                }
            }
        }

        class Clock {
            constructor(app) {
                this.app = app;
                this.dom = {
                    el: document.getElementById('clock')
                };
            }

            start() {
                this.update();
                setInterval(() => this.update(), 1000);
            }

            update() {
                const now = new Date();
                let h = now.getHours();
                let m = now.getMinutes();

                this.app.todo.checkAlarms();

                if (!this.app.state.settings.time24) {
                    h = h % 12;
                    if (h === 0) h = 12;
                }
                const mStr = m < 10 ? '0' + m : m;
                this.dom.el.textContent = `${h}:${mStr}`;
            }
        }
        class Todo {
            constructor(app) {
                this.app = app;
                this.dom = {
                    widget: document.getElementById('todo-widget'),
                    list: document.getElementById('todo-list'),
                    input: document.getElementById('todo-input'),
                    timeInput: document.getElementById('todo-time'),
                    addBtn: document.getElementById('add-todo-btn')
                };
                this.initListeners();
            }

            initListeners() {
                this.dom.addBtn.onclick = () => this.add();
                this.dom.input.onkeypress = (e) => {
                    if (e.key === 'Enter') this.add();
                };
            }

            toggle() {
                this.dom.widget.classList.toggle('active');
            }

            add() {
                const text = this.dom.input.value.trim();
                if (!text) return;

                const newItem = {
                    id: Date.now(),
                    text: text,
                    time: this.dom.timeInput.value,
                    done: false,
                    notified: false
                };

                this.app.state.settings.todos.push(newItem);
                this.app.saveSetting('todos', JSON.stringify(this.app.state.settings.todos));
                this.render();
                this.dom.input.value = '';
                this.dom.timeInput.value = '';
            }

            remove(id) {
                this.app.state.settings.todos = this.app.state.settings.todos.filter(item => item.id !== id);
                this.app.saveSetting('todos', JSON.stringify(this.app.state.settings.todos));
                this.render();
            }

            toggleDone(id) {
                const item = this.app.state.settings.todos.find(item => item.id === id);
                if (item) {
                    item.done = !item.done;
                    this.app.saveSetting('todos', JSON.stringify(this.app.state.settings.todos));
                    this.render();
                }
            }

            checkAlarms() {
                const now = new Date();
                const h = now.getHours();
                const m = now.getMinutes();
                const currentStr = `${h < 10 ? '0' + h : h}:${m < 10 ? '0' + m : m}`;
                let changed = false;

                this.app.state.settings.todos.forEach(item => {
                    if (item.time && !item.notified && item.time === currentStr) {
                        item.notified = true;
                        changed = true;
                        this.app.notifications.pushLocal("Reminder", item.text);
                        if (!this.app.notifications.isOpen()) {
                            this.app.notifications.toggle();
                        }
                    }
                });

                if (changed) {
                    this.app.saveSetting('todos', JSON.stringify(this.app.state.settings.todos));
                    this.render();
                }
            }

            render() {
                this.dom.list.innerHTML = "";
                if (this.app.state.settings.todos.length === 0) {
                    this.dom.list.innerHTML = `<li class="todo-empty">No tasks yet!</li>`;
                    return;
                }

                this.app.state.settings.todos.forEach(item => {
                    const li = document.createElement('li');
                    li.className = `todo-item ${item.done ? 'done' : ''}`;
                    li.dataset.id = item.id;

                    let timeBadge = item.time ? `<div class="todo-time"><i data-lucide="alarm-clock" class="icon-sm"></i> ${item.time}</div>` : '';

                    li.innerHTML = `
                        <div class="todo-marker"></div>
                        <div class="todo-content">
                            <span class="todo-text">${item.text}</span>
                            ${timeBadge}
                        </div>
                        <div class="todo-del"><i data-lucide="trash-2"></i></div>
                    `;

                    li.querySelector('.todo-marker').onclick = () => this.toggleDone(item.id);
                    li.querySelector('.todo-del').onclick = (e) => {
                        e.stopPropagation();
                        this.remove(item.id);
                    };

                    this.dom.list.appendChild(li);
                });
                lucide.createIcons();
            }
        }
        class MusicApp {
            constructor(app) {
                this.app = app;
                this.loaded = false;
                this.dom = {
                    win: document.getElementById('music-window'),
                    header: document.getElementById('mw-header'),
                    iframe: document.getElementById('music-frame'),
                    closeBtn: document.querySelector('.win-close')
                };
                this.initListeners();
            }

            initListeners() {
                this.dom.closeBtn.onclick = () => this.toggle();
            }

            init() {
                if (this.loaded) return;
                this.dom.iframe.srcdoc = this.getIframeHTML();
                this.initDraggable();
                this.loaded = true;
            }

            toggle() {
                const isActive = this.dom.win.classList.toggle('active');
                if (isActive) this.init();
            }

            initDraggable() {
                let isDragging = false, startX, startY;
                let currentX = 0, currentY = 0;

                this.dom.header.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    this.dom.win.classList.add('dragging');
                    startX = e.clientX;
                    startY = e.clientY;
                });

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    
                    this.dom.win.style.setProperty('--drag-x', `${currentX + dx}px`);
                    this.dom.win.style.setProperty('--drag-y', `${currentY + dy}px`);
                });

                document.addEventListener('mouseup', (e) => {
                    if (!isDragging) return;
                    isDragging = false;
                    this.dom.win.classList.remove('dragging');

                    // Save the final position
                    currentX += e.clientX - startX;
                    currentY += e.clientY - startY;
                });
            }
        
            getIframeHTML() {
                return `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"><\/script><style>:root{--bg-oled:#050505;--accent-red:#ff3333;--accent-glow:rgba(255,51,51,0.4);--glass:rgba(20,20,20,0.7);--border:rgba(255,255,255,0.1);--text:#fff;--text-dim:#a0a0a0}*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',-apple-system,system-ui,sans-serif;user-select:none}body{background-color:var(--bg-oled);color:var(--text);height:100vh;width:100vw;overflow:hidden;display:flex;align-items:center;justify-content:center}.ambient-glow{position:absolute;width:100vw;height:100vh;background:radial-gradient(circle at 50% 50%,rgba(255,51,51,0.08) 0%,transparent 70%);z-index:0;pointer-events:none}.nexus-shell{width:100%;height:100%;background:var(--glass);backdrop-filter:blur(60px) saturate(160%);-webkit-backdrop-filter:blur(60px) saturate(160%);display:flex;overflow:hidden;position:relative;z-index:10}.zone-left{flex:1.1;padding:40px;display:flex;flex-direction:column;justify-content:space-between;border-right:1px solid var(--border)}.zone-right{flex:.9;display:flex;flex-direction:column;background:rgba(0,0,0,0.2)}.art-wrapper{width:100%;aspect-ratio:1/1;border-radius:16px;overflow:hidden;box-shadow:0 25px 60px rgba(0,0,0,0.8);position:relative;border:1px solid var(--border);background:#000}#cover-img{width:100%;height:100%;object-fit:cover;transition:transform .8s cubic-bezier(0.16,1,0.3,1)}#video-element{width:100%;height:100%;object-fit:contain;display:none}.track-info{margin-top:25px}.track-title{font-size:2.2rem;font-weight:800;letter-spacing:-1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.track-artist{font-size:1rem;color:var(--accent-red);font-weight:700;margin-top:4px;text-transform:uppercase;letter-spacing:2px;opacity:.9}.controls-stack{margin-top:auto;display:flex;flex-direction:column;gap:20px}input[type=range]{-webkit-appearance:none;width:100%;background:transparent;height:20px;cursor:pointer}input[type=range]::-webkit-slider-runnable-track{width:100%;height:4px;background:rgba(255,255,255,0.1);border-radius:2px}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;height:14px;width:14px;border-radius:50%;background:var(--accent-red);margin-top:-5px;box-shadow:0 0 12px var(--accent-glow);transition:.2s}input[type=range]:active::-webkit-slider-thumb{transform:scale(1.3)}.time-display{display:flex;justify-content:space-between;font-size:.8rem;color:var(--text-dim);font-family:'Monaco',monospace;margin-top:6px}.main-buttons{display:flex;justify-content:center;align-items:center;gap:35px}.btn{background:0 0;border:none;color:var(--text);font-size:1.4rem;cursor:pointer;transition:.3s;opacity:.8}.btn:hover{color:var(--accent-red);opacity:1;transform:scale(1.1)}.btn-play{width:65px;height:65px;border-radius:50%;background:var(--accent-red);color:#fff;display:flex;align-items:center;justify-content:center;font-size:1.6rem;opacity:1;box-shadow:0 10px 25px var(--accent-glow)}.bass-module{background:rgba(255,255,255,0.03);border-radius:14px;padding:18px;border:1px solid var(--border)}.bass-header{display:flex;justify-content:space-between;font-size:.7rem;font-weight:800;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;color:var(--text-dim)}.header-bar{padding:30px;display:flex;justify-content:space-between;align-items:center}.brand{font-weight:900;letter-spacing:3px;font-size:1.1rem}.brand span{color:var(--accent-red)}.file-upload-label{background:var(--accent-red);color:#fff;padding:10px 22px;border-radius:30px;font-size:.75rem;cursor:pointer;transition:.3s;font-weight:700;box-shadow:0 5px 15px var(--accent-glow)}.file-upload-label:hover{transform:translateY(-2px);filter:brightness(1.1)}#file-input{display:none}#visualizer{width:100%;height:100%;flex:1}<\/style><\/head><body><div class="ambient-glow"><\/div><div class="nexus-shell"><div class="zone-left"><div class="art-wrapper"><img id="cover-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><video id="video-element" crossorigin="anonymous" playsinline><\/video><\/div><div class="track-info"><div id="title-display" class="track-title">NexusX Studio<\/div><div id="artist-display" class="track-artist">System Ready<\/div><\/div><div class="controls-stack"><div class="main-buttons"><button class="btn" id="btn-prev"><i class="fas fa-backward"><\/i><\/button><button class="btn btn-play" id="btn-play"><i class="fas fa-play"><\/i><\/button><button class="btn" id="btn-next"><i class="fas fa-forward"><\/i><\/button><\/div><div><input type="range" id="seek-slider" value="0" max="1000"><div class="time-display"><span id="curr-time">0:00<\/span><span id="dur-time">0:00<\/span><\/div><\/div><div class="bass-module"><div class="bass-header"><span>Sub-Bass Enhancement<\/span><span id="bass-val" style="color:var(--accent-red)">0%<\/span><\/div><input type="range" id="bass-slider" min="0" max="100" value="0"><\/div><\/div><\/div><div class="zone-right"><div class="header-bar"><div class="brand">NEXUS<span>STUDIO<\/span><\/div><label for="file-input" class="file-upload-label"><i class="fas fa-plus"><\/i> ADD MEDIA<\/label><input type="file" id="file-input" accept="audio/*,video/*"><\/div><canvas id="visualizer"><\/canvas><\/div><\/div><script>class NexusPlayer{constructor(){this.audioEl=new Audio,this.videoEl=document.getElementById("video-element"),this.activeMedia=this.audioEl,this.audioCtx=null,this.nodes={},this.ui={playBtn:document.getElementById("btn-play"),playIcon:document.querySelector("#btn-play i"),seek:document.getElementById("seek-slider"),bass:document.getElementById("bass-slider"),bassVal:document.getElementById("bass-val"),currTime:document.getElementById("curr-time"),durTime:document.getElementById("dur-time"),fileIn:document.getElementById("file-input"),title:document.getElementById("title-display"),artist:document.getElementById("artist-display"),cover:document.getElementById("cover-img"),canvas:document.getElementById("visualizer")},this.ctx=this.ui.canvas.getContext("2d",{alpha:!1}),this.setupEvents(),this.resize(),window.addEventListener("resize",()=>this.resize())}initAudioEngine(){if(this.audioCtx)return;const e=window.AudioContext||window.webkitAudioContext;this.audioCtx=new e({latencyHint:"playback"}),this.nodes.audioSrc=this.audioCtx.createMediaElementSource(this.audioEl),this.nodes.videoSrc=this.audioCtx.createMediaElementSource(this.videoEl),this.nodes.bassShelf=this.audioCtx.createBiquadFilter(),this.nodes.bassShelf.type="lowshelf",this.nodes.bassShelf.frequency.value=100,this.nodes.bassPunch=this.audioCtx.createBiquadFilter(),this.nodes.bassPunch.type="peaking",this.nodes.bassPunch.frequency.value=60,this.nodes.bassPunch.Q.value=1.5,this.nodes.compressor=this.audioCtx.createDynamicsCompressor(),this.nodes.compressor.threshold.setValueAtTime(-24,this.audioCtx.currentTime),this.nodes.compressor.knee.setValueAtTime(30,this.audioCtx.currentTime),this.nodes.compressor.ratio.setValueAtTime(3,this.audioCtx.currentTime),this.nodes.compressor.attack.setValueAtTime(.003,this.audioCtx.currentTime),this.nodes.compressor.release.setValueAtTime(.25,this.audioCtx.currentTime),this.nodes.analyser=this.audioCtx.createAnalyser(),this.nodes.analyser.fftSize=512,this.nodes.analyser.smoothingTimeConstant=.8,this.nodes.bassShelf.connect(this.nodes.bassPunch),this.nodes.bassPunch.connect(this.nodes.compressor),this.nodes.compressor.connect(this.nodes.analyser),this.nodes.analyser.connect(this.audioCtx.destination),this.routeSource(),this.draw()}routeSource(){this.nodes.audioSrc.disconnect(),this.nodes.videoSrc.disconnect();(this.activeMedia===this.videoEl?this.nodes.videoSrc:this.nodes.audioSrc).connect(this.nodes.bassShelf)}setupEvents(){this.ui.playBtn.onclick=()=>this.toggle(),this.ui.fileIn.onchange=e=>this.load(e.target.files[0]),this.ui.seek.oninput=e=>{const t=e.target.value/1e3*this.activeMedia.duration;this.activeMedia.currentTime=t},this.ui.bass.oninput=e=>{const t=e.target.value;this.ui.bassVal.innerText=\`\${t}%\`,this.nodes.bassShelf&&(this.nodes.bassShelf.gain.setTargetAtTime(.12*t,this.audioCtx.currentTime,.1),this.nodes.bassPunch.gain.setTargetAtTime(.08*t,this.audioCtx.currentTime,.1))};const e=()=>{this.activeMedia.paused||(this.ui.seek.value=this.activeMedia.currentTime/this.activeMedia.duration*1e3||0,this.ui.currTime.innerText=this.format(this.activeMedia.currentTime),this.ui.durTime.innerText=this.format(this.activeMedia.duration)),requestAnimationFrame(e)};e()}async load(e){if(!e)return;this.initAudioEngine(),this.activeMedia.src&&URL.revokeObjectURL(this.activeMedia.src);const t=URL.createObjectURL(e),i=e.type.startsWith("video");this.activeMedia=i?this.videoEl:this.audioEl,this.videoEl.style.display=i?"block":"none",this.ui.cover.style.display=i?"none":"block",this.audioEl.pause(),this.videoEl.pause(),this.activeMedia.src=t,this.routeSource(),this.ui.title.innerText=e.name,this.ui.artist.innerText=i?"Video Media":"Loading Tags...",i||this.getTags(e),this.activeMedia.play().then(()=>{this.ui.playIcon.className="fas fa-pause"})}getTags(e){window.jsmediatags&&window.jsmediatags.read(e,{onSuccess:t=>{this.ui.title.innerText=t.tags.title||e.name,this.ui.artist.innerText=t.tags.artist||"Unknown Artist",t.tags.picture&&(()=>{const{data:e,format:i}=t.tags.picture;let s="";for(let t=0;t<e.length;t++)s+=String.fromCharCode(e[t]);this.ui.cover.src=\`data:\${i};base64,\${btoa(s)}\`})()},onError:()=>{this.ui.artist.innerText="Local Audio"}})}toggle(){this.initAudioEngine(),this.activeMedia.paused?(this.activeMedia.play(),this.ui.playIcon.className="fas fa-pause"):(this.activeMedia.pause(),this.ui.playIcon.className="fas fa-play")}format(e){if(isNaN(e))return"0:00";const t=Math.floor(e/60),i=Math.floor(e%60);return\`\${t}:\${i<10?"0"+i:i}\`}resize(){this.ui.canvas.width=this.ui.canvas.offsetWidth*window.devicePixelRatio,this.ui.canvas.height=this.ui.canvas.offsetHeight*window.devicePixelRatio}draw(){requestAnimationFrame(()=>this.draw());const e=new Uint8Array(this.nodes.analyser.frequencyBinCount);this.nodes.analyser.getByteFrequencyData(e);const t=this.ui.canvas.width,i=this.ui.canvas.height;this.ctx.fillStyle="#050505",this.ctx.fillRect(0,0,t,i);const s=t/e.length*2.5;let o=0;for(let n=0;n<e.length;n++){const a=e[n]/255*i*.8,d=255,l=51,r=51;this.ctx.fillStyle=\`rgba(\${d},\${l},\${r},\${e[n]/255})\`,this.ctx.shadowBlur=15,this.ctx.shadowColor="rgba(255, 51, 51, 0.5)",this.ctx.beginPath(),this.ctx.roundRect(o,i-a,s-4,a,[10,10,0,0]),this.ctx.fill(),o+=s}}}window.onload=()=>new NexusPlayer;<\/script><\/body><\/html>`;
            }
        }

        window.addEventListener('DOMContentLoaded', () => new NexusApp());
    </script>
</body>
</html>
